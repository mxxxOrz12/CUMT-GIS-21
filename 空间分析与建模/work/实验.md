# 空间数据分析之空间自相关

## 柏林房价分析

### 1 数据处理

**数据集来自 2018 年 4 月拍摄的柏林 Airbnb 抓取数据。包括柏林的矢量数据和**

**房价数据，通过geopandas获得柏林每个社区的房价的中位数。**

局部空间自相关就是通过计算每一个空间单元与邻近单元就某一属性的相关程度，对各局部区域中的属性信息进行分析，探究整个区域上同一属性的变化是否平滑(均质)或者存在突变(异质)。


$$
I_{i}=\frac{(x_{i}-\overline{x})}{S^{2}}\sum_{j}w_{ij}(x_{j}-\overline{x})
$$



$$
其中方差为S^{2}=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}\quad\overline{x}=\frac{1}{n}\sum_{i=1}^{n}x_{i}\circ
$$
正的Ⅰ表示该空间单元与邻近单元的观测属性呈现正相关(高值集聚或者低值集聚)，表示一个高值被高值所包围(高-高)或是一个低值被低值所包围(低-低);负的I表示一个高值被低值所包围(高-低)或是一个低值被高值所包围(低-高)。





全局空间自相关主要用于描述区域单元某种现象的整体空间分布情况，以判断该现象在空间上是否存在聚集性。Moran's I统计量和Geary's C统计量是两个用来度量空间自相关的全局指标。其中，Moran指数(又称莫兰指数)反映的是空间邻接或空间邻近的区域单元属性值的相似程度。Geary 指数与Moran指数存在负相关关系。


$$
\mathrm{Moran's}I=\frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_{i}-\overline{x})(x_{j}-\overline{x})}{S^{2}\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}}
$$

$$
Z_{\alpha}=\frac{I-E(I)}{\sqrt{\mathrm{Var}(I)}}
$$

